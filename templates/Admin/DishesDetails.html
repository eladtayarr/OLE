<!DOCTYPE html>
<html>
<head>
    <title>OLE || Adding a Dish</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
<div id="body">
    <h2>Adding a Dish to the Menu</h2><br>

    <form class="opnionForm">

        <label for="Name">The Name of The Dish:</label><br>
        <input type="text" id="Name" name="Name" required><br><br>

        <label for="Description">Description of The Dish:</label><br>
        <input type="text" id="Description" name="Description" required><br><br>

        <label for="Ingredients">Ingredients in The Dish:</label><br>
        <input type="text" id="Ingredients" name="Ingredients" required><br><br>

        <label for="price">The Price of The Dish:</label><br>
        <input type="number" id="price" name="price" required><br><br><br><br><br>

        <button class="button" onclick="addNewDish()">Add Dishs</button><br>
    </form><br>
<div id="result"></div>
</div>
    <script>
        async function addNewDish(event) {
            event.preventDefault();
            const Name = document.getElementById('Name').value;
            const Description = document.getElementById('Description').value;
            const Ingredients = document.getElementById('Ingredients').value;
            const price = document.getElementById('price').value;

            if (price <= 0) {
                alert('Price must be greater than 0.');
                return;
            }
            
            const dishes = {
                Name,
                Description,
                Ingredients,
                price
            };

            try {
                const response = await fetch('/dishes', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(dishes),
                });

                if (response.ok) {
                    console.log('Dish added successfully!');
                    alert('Dish added successfully!');
                    document.getElementById('Name').value = '';
                    document.getElementById('Description').value = '';
                    document.getElementById('Ingredients').value = '';
                    document.getElementById('price').value = '';
                } else {
                    console.error('Failed to add dish:', response.statusText);
                    alert('Failed to add dish. Please try again later.');
                }

            } catch (error) {
                console.error('Error adding dish:', error);
                alert('An error occurred while adding the dish. Please try again later.');
            }
        }
    </script>
</body>
</html>